{"remainingRequest":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\src\\views\\km\\filemanagement\\modules\\UploadForm.vue?vue&type=script&lang=js","dependencies":[{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\src\\views\\km\\filemanagement\\modules\\UploadForm.vue","mtime":1704718217000},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709701155248},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1709701140363},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709701155248},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js","mtime":1709701116791}],"contextDependencies":[],"result":["\n  import { ACCESS_TOKEN } from \"@/store/mutation-types\"\n  import JMultiSelectTag from \"@/components/dict/JMultiSelectTag\"\n  import Vue from \"vue\";\n\n\n  export default {\n    name: 'DraftsForm',\n    components: {\n      JMultiSelectTag,\n    },\n\n    data() {\n      return {\n        fileList:[],\n        url: window._CONFIG['domianURL']+\"/KM/kmDoc/uploadDoc\",\n        confirmLoading: false,\n        headers: {\n          authorization: 'authorization-text',\n          'X-Access-Token': Vue.ls.get(ACCESS_TOKEN)\n        },\n      }\n    },\n    computed: {\n      formDisabled() {\n        return this.disabled\n      },\n    },\n    methods: {\n\n      edit(record) {\n        this.model = Object.assign({}, record);\n        this.visible = true;\n      },\n      submitForm() {\n        this.$emit('ok');\n      },\n\n      // 用来控制上传控件列表的显示\n      handleChange(info) {\n\n        var boolFilelistAdd=true;\n        this.fileList.forEach((item,index)=>{\n             if(item.uid==info.file.uid){\n               boolFilelistAdd=false;\n             }\n        });\n        if(boolFilelistAdd){\n          this.fileList.push(info.file)\n        }\n        if(info.file.status !== 'uploading'){\n          if (info.file.status === 'done') {\n            if(info.file.response.code===200){\n              this.$message.success(`${info.file.name} 文件上传成功`);\n              // this.$emit('nd');\n            }else{\n              this.fileList.forEach((item,index)=>{\n                if(item.uid===info.file.uid){\n                   this.fileList[index].status='error';\n                  this.fileList[index].response=info.file.response.message;\n                }\n              });\n              this.$message.error(`${info.file.name} 文件上传失败${info.file.response.message}`);\n\n            }\n          } else if (info.file.status === 'error') {\n\n            this.fileList.forEach((item,index)=>{\n              if(item.uid===info.file.uid){\n                this.fileList[index].status='error';\n              }\n            });\n            this.$message.error(`${info.file.name} 文件上传失败`);\n          }\n        }\n      },\n    }\n  }\n",{"version":3,"sources":["UploadForm.vue"],"names":[],"mappings":";AAsBA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UploadForm.vue","sourceRoot":"src/views/km/filemanagement/modules","sourcesContent":["<template>\n  <a-spin :spinning=\"confirmLoading\">\n    <a-upload\n      name=\"file\"\n      :multiple=\"true\"\n      :action=\"url\"\n      :headers=\"headers\"\n      @change=\"handleChange\"\n      :file-list=\"fileList\"\n      :showUploadList=\"{showPreviewIcon:true,showRemoveIcon:false}\"\n    >\n      <a-button type=\"primary\">\n        <a-icon type=\"upload\"/>\n        批量上传文件\n      </a-button>\n    </a-upload>\n\n  </a-spin>\n\n</template>\n\n<script>\n  import { ACCESS_TOKEN } from \"@/store/mutation-types\"\n  import JMultiSelectTag from \"@/components/dict/JMultiSelectTag\"\n  import Vue from \"vue\";\n\n\n  export default {\n    name: 'DraftsForm',\n    components: {\n      JMultiSelectTag,\n    },\n\n    data() {\n      return {\n        fileList:[],\n        url: window._CONFIG['domianURL']+\"/KM/kmDoc/uploadDoc\",\n        confirmLoading: false,\n        headers: {\n          authorization: 'authorization-text',\n          'X-Access-Token': Vue.ls.get(ACCESS_TOKEN)\n        },\n      }\n    },\n    computed: {\n      formDisabled() {\n        return this.disabled\n      },\n    },\n    methods: {\n\n      edit(record) {\n        this.model = Object.assign({}, record);\n        this.visible = true;\n      },\n      submitForm() {\n        this.$emit('ok');\n      },\n\n      // 用来控制上传控件列表的显示\n      handleChange(info) {\n\n        var boolFilelistAdd=true;\n        this.fileList.forEach((item,index)=>{\n             if(item.uid==info.file.uid){\n               boolFilelistAdd=false;\n             }\n        });\n        if(boolFilelistAdd){\n          this.fileList.push(info.file)\n        }\n        if(info.file.status !== 'uploading'){\n          if (info.file.status === 'done') {\n            if(info.file.response.code===200){\n              this.$message.success(`${info.file.name} 文件上传成功`);\n              // this.$emit('nd');\n            }else{\n              this.fileList.forEach((item,index)=>{\n                if(item.uid===info.file.uid){\n                   this.fileList[index].status='error';\n                  this.fileList[index].response=info.file.response.message;\n                }\n              });\n              this.$message.error(`${info.file.name} 文件上传失败${info.file.response.message}`);\n\n            }\n          } else if (info.file.status === 'error') {\n\n            this.fileList.forEach((item,index)=>{\n              if(item.uid===info.file.uid){\n                this.fileList[index].status='error';\n              }\n            });\n            this.$message.error(`${info.file.name} 文件上传失败`);\n          }\n        }\n      },\n    }\n  }\n</script>"]}]}