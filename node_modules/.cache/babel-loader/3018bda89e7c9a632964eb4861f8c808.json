{"remainingRequest":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js!F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\src\\views\\km\\filemanagement\\modules\\UploadForm.vue?vue&type=script&lang=js","dependencies":[{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\src\\views\\km\\filemanagement\\modules\\UploadForm.vue","mtime":1704718217000},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\babel.config.js","mtime":1704718217000},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709701155248},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1709701140363},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709701155248},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js","mtime":1709701116791}],"contextDependencies":[],"result":["import { ACCESS_TOKEN } from \"@/store/mutation-types\";\nimport JMultiSelectTag from \"@/components/dict/JMultiSelectTag\";\nimport Vue from \"vue\";\nexport default {\n  name: 'DraftsForm',\n  components: {\n    JMultiSelectTag: JMultiSelectTag\n  },\n  data: function data() {\n    return {\n      fileList: [],\n      url: window._CONFIG['domianURL'] + \"/KM/kmDoc/uploadDoc\",\n      confirmLoading: false,\n      headers: {\n        authorization: 'authorization-text',\n        'X-Access-Token': Vue.ls.get(ACCESS_TOKEN)\n      }\n    };\n  },\n  computed: {\n    formDisabled: function formDisabled() {\n      return this.disabled;\n    }\n  },\n  methods: {\n    edit: function edit(record) {\n      this.model = Object.assign({}, record);\n      this.visible = true;\n    },\n    submitForm: function submitForm() {\n      this.$emit('ok');\n    },\n    // 用来控制上传控件列表的显示\n    handleChange: function handleChange(info) {\n      var _this = this;\n      var boolFilelistAdd = true;\n      this.fileList.forEach(function (item, index) {\n        if (item.uid == info.file.uid) {\n          boolFilelistAdd = false;\n        }\n      });\n      if (boolFilelistAdd) {\n        this.fileList.push(info.file);\n      }\n      if (info.file.status !== 'uploading') {\n        if (info.file.status === 'done') {\n          if (info.file.response.code === 200) {\n            this.$message.success(\"\".concat(info.file.name, \" \\u6587\\u4EF6\\u4E0A\\u4F20\\u6210\\u529F\"));\n            // this.$emit('nd');\n          } else {\n            this.fileList.forEach(function (item, index) {\n              if (item.uid === info.file.uid) {\n                _this.fileList[index].status = 'error';\n                _this.fileList[index].response = info.file.response.message;\n              }\n            });\n            this.$message.error(\"\".concat(info.file.name, \" \\u6587\\u4EF6\\u4E0A\\u4F20\\u5931\\u8D25\").concat(info.file.response.message));\n          }\n        } else if (info.file.status === 'error') {\n          this.fileList.forEach(function (item, index) {\n            if (item.uid === info.file.uid) {\n              _this.fileList[index].status = 'error';\n            }\n          });\n          this.$message.error(\"\".concat(info.file.name, \" \\u6587\\u4EF6\\u4E0A\\u4F20\\u5931\\u8D25\"));\n        }\n      }\n    }\n  }\n};",{"version":3,"names":["ACCESS_TOKEN","JMultiSelectTag","Vue","name","components","data","fileList","url","window","_CONFIG","confirmLoading","headers","authorization","ls","get","computed","formDisabled","disabled","methods","edit","record","model","Object","assign","visible","submitForm","$emit","handleChange","info","_this","boolFilelistAdd","forEach","item","index","uid","file","push","status","response","code","$message","success","concat","message","error"],"sources":["src/views/km/filemanagement/modules/UploadForm.vue"],"sourcesContent":["<template>\n  <a-spin :spinning=\"confirmLoading\">\n    <a-upload\n      name=\"file\"\n      :multiple=\"true\"\n      :action=\"url\"\n      :headers=\"headers\"\n      @change=\"handleChange\"\n      :file-list=\"fileList\"\n      :showUploadList=\"{showPreviewIcon:true,showRemoveIcon:false}\"\n    >\n      <a-button type=\"primary\">\n        <a-icon type=\"upload\"/>\n        批量上传文件\n      </a-button>\n    </a-upload>\n\n  </a-spin>\n\n</template>\n\n<script>\n  import { ACCESS_TOKEN } from \"@/store/mutation-types\"\n  import JMultiSelectTag from \"@/components/dict/JMultiSelectTag\"\n  import Vue from \"vue\";\n\n\n  export default {\n    name: 'DraftsForm',\n    components: {\n      JMultiSelectTag,\n    },\n\n    data() {\n      return {\n        fileList:[],\n        url: window._CONFIG['domianURL']+\"/KM/kmDoc/uploadDoc\",\n        confirmLoading: false,\n        headers: {\n          authorization: 'authorization-text',\n          'X-Access-Token': Vue.ls.get(ACCESS_TOKEN)\n        },\n      }\n    },\n    computed: {\n      formDisabled() {\n        return this.disabled\n      },\n    },\n    methods: {\n\n      edit(record) {\n        this.model = Object.assign({}, record);\n        this.visible = true;\n      },\n      submitForm() {\n        this.$emit('ok');\n      },\n\n      // 用来控制上传控件列表的显示\n      handleChange(info) {\n\n        var boolFilelistAdd=true;\n        this.fileList.forEach((item,index)=>{\n             if(item.uid==info.file.uid){\n               boolFilelistAdd=false;\n             }\n        });\n        if(boolFilelistAdd){\n          this.fileList.push(info.file)\n        }\n        if(info.file.status !== 'uploading'){\n          if (info.file.status === 'done') {\n            if(info.file.response.code===200){\n              this.$message.success(`${info.file.name} 文件上传成功`);\n              // this.$emit('nd');\n            }else{\n              this.fileList.forEach((item,index)=>{\n                if(item.uid===info.file.uid){\n                   this.fileList[index].status='error';\n                  this.fileList[index].response=info.file.response.message;\n                }\n              });\n              this.$message.error(`${info.file.name} 文件上传失败${info.file.response.message}`);\n\n            }\n          } else if (info.file.status === 'error') {\n\n            this.fileList.forEach((item,index)=>{\n              if(item.uid===info.file.uid){\n                this.fileList[index].status='error';\n              }\n            });\n            this.$message.error(`${info.file.name} 文件上传失败`);\n          }\n        }\n      },\n    }\n  }\n</script>"],"mappings":"AAsBA,SAAAA,YAAA;AACA,OAAAC,eAAA;AACA,OAAAC,GAAA;AAGA;EACAC,IAAA;EACAC,UAAA;IACAH,eAAA,EAAAA;EACA;EAEAI,IAAA,WAAAA,KAAA;IACA;MACAC,QAAA;MACAC,GAAA,EAAAC,MAAA,CAAAC,OAAA;MACAC,cAAA;MACAC,OAAA;QACAC,aAAA;QACA,kBAAAV,GAAA,CAAAW,EAAA,CAAAC,GAAA,CAAAd,YAAA;MACA;IACA;EACA;EACAe,QAAA;IACAC,YAAA,WAAAA,aAAA;MACA,YAAAC,QAAA;IACA;EACA;EACAC,OAAA;IAEAC,IAAA,WAAAA,KAAAC,MAAA;MACA,KAAAC,KAAA,GAAAC,MAAA,CAAAC,MAAA,KAAAH,MAAA;MACA,KAAAI,OAAA;IACA;IACAC,UAAA,WAAAA,WAAA;MACA,KAAAC,KAAA;IACA;IAEA;IACAC,YAAA,WAAAA,aAAAC,IAAA;MAAA,IAAAC,KAAA;MAEA,IAAAC,eAAA;MACA,KAAAxB,QAAA,CAAAyB,OAAA,WAAAC,IAAA,EAAAC,KAAA;QACA,IAAAD,IAAA,CAAAE,GAAA,IAAAN,IAAA,CAAAO,IAAA,CAAAD,GAAA;UACAJ,eAAA;QACA;MACA;MACA,IAAAA,eAAA;QACA,KAAAxB,QAAA,CAAA8B,IAAA,CAAAR,IAAA,CAAAO,IAAA;MACA;MACA,IAAAP,IAAA,CAAAO,IAAA,CAAAE,MAAA;QACA,IAAAT,IAAA,CAAAO,IAAA,CAAAE,MAAA;UACA,IAAAT,IAAA,CAAAO,IAAA,CAAAG,QAAA,CAAAC,IAAA;YACA,KAAAC,QAAA,CAAAC,OAAA,IAAAC,MAAA,CAAAd,IAAA,CAAAO,IAAA,CAAAhC,IAAA;YACA;UACA;YACA,KAAAG,QAAA,CAAAyB,OAAA,WAAAC,IAAA,EAAAC,KAAA;cACA,IAAAD,IAAA,CAAAE,GAAA,KAAAN,IAAA,CAAAO,IAAA,CAAAD,GAAA;gBACAL,KAAA,CAAAvB,QAAA,CAAA2B,KAAA,EAAAI,MAAA;gBACAR,KAAA,CAAAvB,QAAA,CAAA2B,KAAA,EAAAK,QAAA,GAAAV,IAAA,CAAAO,IAAA,CAAAG,QAAA,CAAAK,OAAA;cACA;YACA;YACA,KAAAH,QAAA,CAAAI,KAAA,IAAAF,MAAA,CAAAd,IAAA,CAAAO,IAAA,CAAAhC,IAAA,2CAAAuC,MAAA,CAAAd,IAAA,CAAAO,IAAA,CAAAG,QAAA,CAAAK,OAAA;UAEA;QACA,WAAAf,IAAA,CAAAO,IAAA,CAAAE,MAAA;UAEA,KAAA/B,QAAA,CAAAyB,OAAA,WAAAC,IAAA,EAAAC,KAAA;YACA,IAAAD,IAAA,CAAAE,GAAA,KAAAN,IAAA,CAAAO,IAAA,CAAAD,GAAA;cACAL,KAAA,CAAAvB,QAAA,CAAA2B,KAAA,EAAAI,MAAA;YACA;UACA;UACA,KAAAG,QAAA,CAAAI,KAAA,IAAAF,MAAA,CAAAd,IAAA,CAAAO,IAAA,CAAAhC,IAAA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]}]}