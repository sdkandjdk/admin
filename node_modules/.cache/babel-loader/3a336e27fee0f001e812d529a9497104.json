{"remainingRequest":"F:\\workspace\\3月\\知识库系统\\admin\\node_modules\\babel-loader\\lib\\index.js!F:\\workspace\\3月\\知识库系统\\admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\workspace\\3月\\知识库系统\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\workspace\\3月\\知识库系统\\admin\\src\\views\\system\\DepartUserList.vue?vue&type=script&lang=js","dependencies":[{"path":"F:\\workspace\\3月\\知识库系统\\admin\\src\\views\\system\\DepartUserList.vue","mtime":1704718217000},{"path":"F:\\workspace\\3月\\知识库系统\\admin\\babel.config.js","mtime":1704718217000},{"path":"F:\\workspace\\3月\\知识库系统\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709701155248},{"path":"F:\\workspace\\3月\\知识库系统\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1709701140363},{"path":"F:\\workspace\\3月\\知识库系统\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709701155248},{"path":"F:\\workspace\\3月\\知识库系统\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1709701116791}],"contextDependencies":[],"result":["import DeptBaseInfo from './modules/DeptBaseInfo';\nimport DeptUserInfo from './modules/DeptUserInfo';\nimport { queryMyDepartTreeList, searchByKeywords } from '@/api/api';\nimport { JeecgListMixin } from '@/mixins/JeecgListMixin';\nimport DeptRoleInfo from './modules/DeptRoleInfo';\nexport default {\n  name: 'DepartUserList',\n  mixins: [JeecgListMixin],\n  components: {\n    DeptRoleInfo: DeptRoleInfo,\n    DeptBaseInfo: DeptBaseInfo,\n    DeptUserInfo: DeptUserInfo\n  },\n  data: function data() {\n    return {\n      currentDeptId: '',\n      iExpandedKeys: [],\n      loading: false,\n      autoExpandParent: true,\n      currFlowId: '',\n      currFlowName: '',\n      disable: true,\n      treeData: [],\n      visible: false,\n      departTree: [],\n      rightClickSelectedKey: '',\n      hiding: true,\n      model: {},\n      dropTrigger: '',\n      depart: {},\n      disableSubmit: false,\n      checkedKeys: [],\n      selectedKeys: [],\n      autoIncr: 1,\n      currSelected: {},\n      form: this.$form.createForm(this),\n      labelCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 5\n        }\n      },\n      wrapperCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 16\n        }\n      },\n      graphDatasource: {\n        nodes: [],\n        edges: []\n      },\n      userIdentity: \"\"\n    };\n  },\n  methods: {\n    callback: function callback(key) {\n      //console.log(key)\n    },\n    loadData: function loadData() {\n      this.refresh();\n    },\n    clearSelectedDepartKeys: function clearSelectedDepartKeys() {\n      this.checkedKeys = [];\n      this.selectedKeys = [];\n      this.currentDeptId = '';\n      this.$refs.DeptUserInfo.currentDeptId = '';\n      this.$refs.DeptRoleInfo.currentDeptId = '';\n    },\n    loadTree: function loadTree() {\n      var _this = this;\n      var that = this;\n      that.treeData = [];\n      that.departTree = [];\n      queryMyDepartTreeList().then(function (res) {\n        if (res.success && res.result) {\n          for (var i = 0; i < res.result.length; i++) {\n            var temp = res.result[i];\n            that.treeData.push(temp);\n            that.departTree.push(temp);\n            that.setThisExpandedKeys(temp);\n            // console.log(temp.id)\n          }\n          _this.loading = false;\n        }\n        that.userIdentity = res.message;\n      });\n    },\n    setThisExpandedKeys: function setThisExpandedKeys(node) {\n      //只展开一级目录\n      if (node.children && node.children.length > 0) {\n        this.iExpandedKeys.push(node.key);\n        //下方代码放开注释则默认展开所有节点\n        /**\n        for (let a = 0; a < node.children.length; a++) {\n          this.setThisExpandedKeys(node.children[a])\n        }\n        */\n      }\n    },\n    refresh: function refresh() {\n      this.loading = true;\n      this.loadTree();\n    },\n    onExpand: function onExpand(expandedKeys) {\n      // console.log('onExpand', expandedKeys)\n      // if not set autoExpandParent to false, if children expanded, parent can not collapse.\n      // or, you can remove all expanded children keys.\n      this.iExpandedKeys = expandedKeys;\n      this.autoExpandParent = false;\n    },\n    onSearch: function onSearch(value) {\n      var that = this;\n      if (value) {\n        searchByKeywords({\n          keyWord: value,\n          myDeptSearch: '1'\n        }).then(function (res) {\n          if (res.success) {\n            that.departTree = [];\n            for (var i = 0; i < res.result.length; i++) {\n              var temp = res.result[i];\n              that.departTree.push(temp);\n            }\n          } else {\n            that.$message.warning(res.message);\n          }\n        });\n      } else {\n        that.loadTree();\n      }\n    },\n    onCheck: function onCheck(checkedKeys, e) {\n      var record = e.node.dataRef;\n      // console.log('onCheck', checkedKeys, e);\n      this.checkedKeys = [];\n      // if (e.checked === true) {\n      this.currentDeptId = record.id;\n      this.checkedKeys.push(record.id);\n      this.$refs.DeptBaseInfo.open(record);\n      this.$refs.DeptUserInfo.open(record);\n      this.$refs.DeptRoleInfo.open(record);\n      // }\n      // else {\n      //   this.checkedKeys = [];\n      //   this.$refs.DeptBaseInfo.clearForm();\n      //   this.$refs.DeptUserInfo.clearList();\n      // }\n\n      this.hiding = false;\n      // this.checkedKeys = checkedKeys.checked\n    },\n    onSelect: function onSelect(selectedKeys, e) {\n      if (this.selectedKeys[0] !== selectedKeys[0]) {\n        this.selectedKeys = [selectedKeys[0]];\n      }\n      var record = e.node.dataRef;\n      this.checkedKeys.push(record.id);\n      this.$refs.DeptBaseInfo.open(record);\n      this.$refs.DeptUserInfo.onClearSelected();\n      this.$refs.DeptUserInfo.open(record);\n      this.$refs.DeptRoleInfo.onClearSelected();\n      this.$refs.DeptRoleInfo.open(record);\n    }\n  },\n  created: function created() {\n    this.currFlowId = this.$route.params.id;\n    this.currFlowName = this.$route.params.name;\n    // this.loadTree()\n  }\n};",{"version":3,"names":["DeptBaseInfo","DeptUserInfo","queryMyDepartTreeList","searchByKeywords","JeecgListMixin","DeptRoleInfo","name","mixins","components","data","currentDeptId","iExpandedKeys","loading","autoExpandParent","currFlowId","currFlowName","disable","treeData","visible","departTree","rightClickSelectedKey","hiding","model","dropTrigger","depart","disableSubmit","checkedKeys","selectedKeys","autoIncr","currSelected","form","$form","createForm","labelCol","xs","span","sm","wrapperCol","graphDatasource","nodes","edges","userIdentity","methods","callback","key","loadData","refresh","clearSelectedDepartKeys","$refs","loadTree","_this","that","then","res","success","result","i","length","temp","push","setThisExpandedKeys","message","node","children","onExpand","expandedKeys","onSearch","value","keyWord","myDeptSearch","$message","warning","onCheck","e","record","dataRef","id","open","onSelect","onClearSelected","created","$route","params"],"sources":["src/views/system/DepartUserList.vue"],"sourcesContent":["<template>\n  <a-row :gutter=\"10\">\n    <a-col :md=\"8\" :sm=\"24\">\n      <a-card :bordered=\"false\">\n        <div style=\"background: #fff;padding-left:16px;height: 100%; margin-top: 5px\">\n          <a-input-search @search=\"onSearch\" style=\"width:100%;margin-top: 10px\" placeholder=\"请输入部门名称\"/>\n          <!-- 树-->\n\n          <template v-if=\"userIdentity === '2' && departTree.length>0\">\n\n            <!--组织机构-->\n            <a-tree\n              showLine\n              :selectedKeys=\"selectedKeys\"\n              :checkStrictly=\"true\"\n              @select=\"onSelect\"\n              :dropdownStyle=\"{maxHeight:'200px',overflow:'auto'}\"\n              :treeData=\"departTree\"\n              :autoExpandParent=\"autoExpandParent\"\n              :expandedKeys=\"iExpandedKeys\"\n              @expand=\"onExpand\"\n            />\n\n          </template>\n          <div style=\"margin-top: 24px;\" v-else-if=\"userIdentity === '2' && departTree.length==0\">\n            <h3><span>您的部门下暂无有效部门信息</span></h3>\n          </div>\n          <div style=\"margin-top: 24px;\" v-else><h3>普通员工暂无此权限</h3></div>\n        </div>\n      </a-card>\n    </a-col>\n    <a-col :md=\"16\" :sm=\"24\">\n      <a-card :bordered=\"false\">\n        <a-tabs defaultActiveKey=\"2\" @change=\"callback\">\n          <a-tab-pane tab=\"基本信息\" key=\"1\" forceRender>\n            <Dept-Base-Info ref=\"DeptBaseInfo\"></Dept-Base-Info>\n          </a-tab-pane>\n          <a-tab-pane tab=\"用户信息\" key=\"2\">\n            <Dept-User-Info ref=\"DeptUserInfo\" @clearSelectedDepartKeys=\"clearSelectedDepartKeys\"></Dept-User-Info>\n          </a-tab-pane>\n          <a-tab-pane tab=\"部门角色\" key=\"3\" forceRender>\n            <dept-role-info ref=\"DeptRoleInfo\" @clearSelectedDepartKeys=\"clearSelectedDepartKeys\"/>\n          </a-tab-pane>\n        </a-tabs>\n      </a-card>\n    </a-col>\n  </a-row>\n</template>\n<script>\n  import DeptBaseInfo from './modules/DeptBaseInfo'\n  import DeptUserInfo from './modules/DeptUserInfo'\n  import { queryMyDepartTreeList, searchByKeywords } from '@/api/api'\n  import { JeecgListMixin } from '@/mixins/JeecgListMixin'\n  import DeptRoleInfo from './modules/DeptRoleInfo'\n\n  export default {\n    name: 'DepartUserList',\n    mixins: [JeecgListMixin],\n    components: {\n      DeptRoleInfo,\n      DeptBaseInfo,\n      DeptUserInfo,\n    },\n    data() {\n      return {\n        currentDeptId: '',\n        iExpandedKeys: [],\n        loading: false,\n        autoExpandParent: true,\n        currFlowId: '',\n        currFlowName: '',\n        disable: true,\n        treeData: [],\n        visible: false,\n        departTree: [],\n        rightClickSelectedKey: '',\n        hiding: true,\n        model: {},\n        dropTrigger: '',\n        depart: {},\n        disableSubmit: false,\n        checkedKeys: [],\n        selectedKeys: [],\n        autoIncr: 1,\n        currSelected: {},\n        form: this.$form.createForm(this),\n        labelCol: {\n          xs: {span: 24},\n          sm: {span: 5}\n        },\n        wrapperCol: {\n          xs: {span: 24},\n          sm: {span: 16}\n        },\n        graphDatasource: {\n          nodes: [],\n          edges: []\n        },\n        userIdentity:\"\",\n      }\n    },\n    methods: {\n      callback(key) {\n        //console.log(key)\n      },\n      loadData() {\n        this.refresh();\n      },\n      clearSelectedDepartKeys() {\n        this.checkedKeys = [];\n        this.selectedKeys = [];\n        this.currentDeptId = '';\n        this.$refs.DeptUserInfo.currentDeptId='';\n        this.$refs.DeptRoleInfo.currentDeptId='';\n      },\n      loadTree() {\n        var that = this\n        that.treeData = []\n        that.departTree = []\n        queryMyDepartTreeList().then((res) => {\n          if (res.success && res.result ) {\n            for (let i = 0; i < res.result.length; i++) {\n              let temp = res.result[i]\n              that.treeData.push(temp)\n              that.departTree.push(temp)\n              that.setThisExpandedKeys(temp)\n              // console.log(temp.id)\n            }\n            this.loading = false\n          }\n          that.userIdentity = res.message\n        })\n      },\n      setThisExpandedKeys(node) {\n        //只展开一级目录\n        if (node.children && node.children.length > 0) {\n          this.iExpandedKeys.push(node.key)\n          //下方代码放开注释则默认展开所有节点\n          /**\n          for (let a = 0; a < node.children.length; a++) {\n            this.setThisExpandedKeys(node.children[a])\n          }\n          */\n        }\n      },\n      refresh() {\n        this.loading = true\n        this.loadTree()\n      },\n\n      onExpand(expandedKeys) {\n        // console.log('onExpand', expandedKeys)\n        // if not set autoExpandParent to false, if children expanded, parent can not collapse.\n        // or, you can remove all expanded children keys.\n        this.iExpandedKeys = expandedKeys\n        this.autoExpandParent = false\n      },\n\n      onSearch(value) {\n        let that = this\n        if (value) {\n          searchByKeywords({keyWord: value,myDeptSearch:'1'}).then((res) => {\n            if (res.success) {\n              that.departTree = []\n              for (let i = 0; i < res.result.length; i++) {\n                let temp = res.result[i]\n                that.departTree.push(temp)\n              }\n            } else {\n              that.$message.warning(res.message)\n            }\n          })\n        } else {\n          that.loadTree()\n        }\n\n      },\n      onCheck(checkedKeys, e) {\n        let record = e.node.dataRef;\n        // console.log('onCheck', checkedKeys, e);\n        this.checkedKeys = [];\n        // if (e.checked === true) {\n        this.currentDeptId = record.id;\n        this.checkedKeys.push(record.id);\n\n        this.$refs.DeptBaseInfo.open(record);\n        this.$refs.DeptUserInfo.open(record);\n        this.$refs.DeptRoleInfo.open(record);\n        // }\n        // else {\n        //   this.checkedKeys = [];\n        //   this.$refs.DeptBaseInfo.clearForm();\n        //   this.$refs.DeptUserInfo.clearList();\n        // }\n\n        this.hiding = false;\n        // this.checkedKeys = checkedKeys.checked\n      },\n      onSelect(selectedKeys, e) {\n        if (this.selectedKeys[0] !== selectedKeys[0]) {\n          this.selectedKeys = [selectedKeys[0]];\n        }\n        let record = e.node.dataRef;\n        this.checkedKeys.push(record.id);\n        this.$refs.DeptBaseInfo.open(record);\n        this.$refs.DeptUserInfo.onClearSelected();\n        this.$refs.DeptUserInfo.open(record);\n        this.$refs.DeptRoleInfo.onClearSelected();\n        this.$refs.DeptRoleInfo.open(record);\n      },\n    },\n    created() {\n      this.currFlowId = this.$route.params.id\n      this.currFlowName = this.$route.params.name\n      // this.loadTree()\n    },\n  }\n</script>\n<style scoped>\n  @import '~@assets/less/common.less'\n</style>"],"mappings":"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","ignoreList":[]}]}