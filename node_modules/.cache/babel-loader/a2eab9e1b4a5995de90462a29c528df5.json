{"remainingRequest":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js!F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\src\\views\\system\\modules\\UserRecycleBinModal.vue?vue&type=script&lang=js","dependencies":[{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\src\\views\\system\\modules\\UserRecycleBinModal.vue","mtime":1704718217000},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\babel.config.js","mtime":1704718217000},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709701155248},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1709701140363},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709701155248},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js","mtime":1709701116791}],"contextDependencies":[],"result":["import { putAction, deleteAction, getFileAccessHttpUrl } from \"@/api/manage\";\n\n// 高度封装的请求，请务必使用 superRequest.call(this,{}) 的方式调用\nfunction superRequest(options) {\n  var _this = this;\n  this.loading = !!options.loading;\n  options.promise.then(function (res) {\n    if (res.success && typeof options.success === 'function') {\n      options.success(res);\n    } else {\n      throw new Error(res.message);\n    }\n  }).catch(function (e) {\n    console.error('查询已删除的用户失败：', e);\n    _this.$message.warning('查询已删除的用户失败：' + (e.message || e));\n  }).finally(function () {\n    _this.loading = false;\n  });\n}\nexport default {\n  name: 'UserRecycleBinModal',\n  props: {\n    visible: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data: function data() {\n    return {\n      title: '用户回收站',\n      loading: false,\n      innerVisible: false,\n      selectedRowKeys: [],\n      dataSource: [],\n      columns: [{\n        title: '#',\n        align: 'center',\n        key: 'rowIndex',\n        width: 80,\n        customRender: function customRender(t, r, i) {\n          return i + 1;\n        }\n      }, {\n        title: '账号',\n        align: 'center',\n        dataIndex: 'username'\n      }, {\n        title: '姓名',\n        align: 'center',\n        dataIndex: 'realname'\n      }, {\n        title: '头像',\n        align: 'center',\n        dataIndex: 'avatar',\n        scopedSlots: {\n          customRender: 'avatarslot'\n        }\n      }, {\n        title: '部门',\n        align: 'center',\n        dataIndex: 'orgCode'\n      }, {\n        title: '操作',\n        align: 'center',\n        dataIndex: 'action',\n        width: 200,\n        scopedSlots: {\n          customRender: 'action'\n        }\n      }],\n      url: {\n        getAvatar: function getAvatar(path) {\n          return getFileAccessHttpUrl(\"\".concat(path));\n        },\n        // 回收站操作，get = 获取列表；put = 取回；delete = 彻底删除\n        recycleBin: '/sys/user/recycleBin',\n        putRecycleBin: '/sys/user/putRecycleBin',\n        deleteRecycleBin: '/sys/user/deleteRecycleBin'\n      }\n    };\n  },\n  watch: {\n    visible: {\n      immediate: true,\n      handler: function handler(val) {\n        if (val) {\n          this.loadData();\n        }\n        this.innerVisible = val;\n      }\n    },\n    innerVisible: function innerVisible(val) {\n      this.$emit('update:visible', val);\n    }\n  },\n  methods: {\n    loadData: function loadData() {\n      var _this2 = this;\n      superRequest.call(this, {\n        loading: true,\n        promise: this.$http.get(this.url.recycleBin),\n        success: function success(res) {\n          return _this2.dataSource = res.result;\n        }\n      });\n    },\n    handleOk: function handleOk() {\n      this.loadData();\n      this.$emit('ok');\n    },\n    handleCancel: function handleCancel() {\n      this.innerVisible = false;\n    },\n    // 还原用户\n    handleRevert: function handleRevert(userIds) {\n      var _this3 = this;\n      this.$confirm({\n        title: '恢复用户',\n        content: \"\\u60A8\\u786E\\u5B9A\\u8981\\u6062\\u590D\\u8FD9 \".concat(userIds.length, \" \\u4E2A\\u7528\\u6237\\u5417\\uFF1F\"),\n        centered: true,\n        onOk: function onOk() {\n          putAction(_this3.url.putRecycleBin, {\n            userIds: userIds.join(',')\n          }).then(function (res) {\n            if (res.success) {\n              _this3.handleOk();\n              _this3.handleClearSelection();\n              _this3.$message.success(\"\\u8FD8\\u539F \".concat(userIds.length, \" \\u4E2A\\u7528\\u6237\\u6210\\u529F\\uFF01\"));\n            }\n          });\n        }\n      });\n    },\n    // 彻底删除用户\n    handleDelete: function handleDelete(userIds) {\n      var _this4 = this;\n      var h = this.$createElement;\n      this.$confirm({\n        title: '彻底删除用户',\n        content: h(\"div\", [h(\"p\", [\"\\u60A8\\u786E\\u5B9A\\u8981\\u5F7B\\u5E95\\u5220\\u9664\\u8FD9 \", userIds.length, \" \\u4E2A\\u7528\\u6237\\u5417\\uFF1F\"]), h(\"p\", {\n          \"style\": \"color:red;\"\n        }, [\"\\u6CE8\\u610F\\uFF1A\\u5F7B\\u5E95\\u5220\\u9664\\u540E\\u5C06\\u65E0\\u6CD5\\u6062\\u590D\\uFF0C\\u8BF7\\u8C28\\u614E\\u64CD\\u4F5C\\uFF01\"])]),\n        centered: true,\n        onOk: function onOk() {\n          var that = _this4;\n          deleteAction(that.url.deleteRecycleBin, {\n            userIds: userIds.join(',')\n          }).then(function (res) {\n            if (res.success) {\n              _this4.loadData();\n              _this4.handleClearSelection();\n              _this4.$message.success(\"\\u5F7B\\u5E95\\u5220\\u9664 \".concat(userIds.length, \" \\u4E2A\\u7528\\u6237\\u6210\\u529F\\uFF01\"));\n            } else {\n              that.$message.warning(res.message);\n            }\n          });\n        }\n      });\n    },\n    handleRevertBatch: function handleRevertBatch() {\n      this.handleRevert(this.selectedRowKeys);\n    },\n    handleDeleteBatch: function handleDeleteBatch() {\n      this.handleDelete(this.selectedRowKeys);\n    },\n    handleClearSelection: function handleClearSelection() {\n      this.handleTableSelectChange([], []);\n    },\n    handleTableSelectChange: function handleTableSelectChange(selectedRowKeys, selectionRows) {\n      this.selectedRowKeys = selectedRowKeys;\n      this.selectionRows = selectionRows;\n    }\n  }\n};",{"version":3,"names":["putAction","deleteAction","getFileAccessHttpUrl","superRequest","options","_this","loading","promise","then","res","success","Error","message","catch","e","console","error","$message","warning","finally","name","props","visible","type","Boolean","default","data","title","innerVisible","selectedRowKeys","dataSource","columns","align","key","width","customRender","t","r","i","dataIndex","scopedSlots","url","getAvatar","path","concat","recycleBin","putRecycleBin","deleteRecycleBin","watch","immediate","handler","val","loadData","$emit","methods","_this2","call","$http","get","result","handleOk","handleCancel","handleRevert","userIds","_this3","$confirm","content","length","centered","onOk","join","handleClearSelection","handleDelete","_this4","h","$createElement","that","handleRevertBatch","handleDeleteBatch","handleTableSelectChange","selectionRows"],"sources":["src/views/system/modules/UserRecycleBinModal.vue"],"sourcesContent":["<template>\n  <a-modal\n    :width=\"1000\"\n    :title=\"title\"\n    :visible=\"innerVisible\"\n    @cancel=\"handleCancel\"\n    cancelText=\"关闭\"\n    :okButtonProps=\"{style:{display:'none'}}\"\n  >\n    <a-alert type=\"info\" showIcon style=\"margin-bottom: 16px;\">\n      <template slot=\"message\">\n        <span>已选择</span>\n        <a style=\"font-weight: 600;padding: 0 4px;\">{{ selectedRowKeys.length }}</a>\n        <span>项</span>\n        <template v-if=\"selectedRowKeys.length>0\">\n          <a-divider type=\"vertical\"/>\n          <a @click=\"handleClearSelection\">清空选择</a>\n          <a-divider type=\"vertical\"/>\n          <a @click=\"handleRevertBatch\">批量还原</a>\n          <a-divider type=\"vertical\"/>\n          <a @click=\"handleDeleteBatch\">批量删除</a>\n        </template>\n      </template>\n    </a-alert>\n\n    <a-table\n      ref=\"table\"\n      rowKey=\"id\"\n      size=\"middle\"\n      bordered\n      :columns=\"columns\"\n      :loading=\"loading\"\n      :dataSource=\"dataSource\"\n      :pagination=\"false\"\n      :rowSelection=\"{selectedRowKeys, onChange: handleTableSelectChange}\"\n    >\n\n      <!-- 显示头像 -->\n      <template slot=\"avatarslot\" slot-scope=\"text, record, index\">\n        <div class=\"anty-img-wrap\">\n          <a-avatar shape=\"square\" :src=\"url.getAvatar(record.avatar)\" icon=\"user\"/>\n        </div>\n      </template>\n\n      <span slot=\"action\" slot-scope=\"text, record\">\n        <a @click=\"handleRevert([record.id])\"><a-icon type=\"redo\"/> 还原用户</a>\n        <a-divider type=\"vertical\"/>\n        <a @click=\"handleDelete([record.id])\"><a-icon type=\"delete\"/> 彻底删除</a>\n      </span>\n    </a-table>\n\n  </a-modal>\n</template>\n\n<script>\n  import { putAction,deleteAction,getFileAccessHttpUrl } from \"@/api/manage\"\n\n  // 高度封装的请求，请务必使用 superRequest.call(this,{}) 的方式调用\n  function superRequest(options) {\n    this.loading = !!options.loading\n    options.promise.then(res => {\n      if (res.success && typeof options.success === 'function') {\n        options.success(res)\n      } else {\n        throw new Error(res.message)\n      }\n    }).catch(e => {\n      console.error('查询已删除的用户失败：', e)\n      this.$message.warning('查询已删除的用户失败：' + (e.message || e))\n    }).finally(() => {\n      this.loading = false\n    })\n  }\n\n  export default {\n    name: 'UserRecycleBinModal',\n    props: {\n      visible: {\n        type: Boolean,\n        default: false\n      },\n    },\n    data() {\n      return {\n        title: '用户回收站',\n        loading: false,\n        innerVisible: false,\n        selectedRowKeys: [],\n        dataSource: [],\n        columns: [\n          { title: '#', align: 'center', key: 'rowIndex', width: 80, customRender: (t, r, i) => i + 1 },\n          { title: '账号', align: 'center', dataIndex: 'username' },\n          { title: '姓名', align: 'center', dataIndex: 'realname', },\n          { title: '头像', align: 'center', dataIndex: 'avatar', scopedSlots: { customRender: 'avatarslot' } },\n          { title: '部门', align: 'center', dataIndex: 'orgCode' },\n          { title: '操作', align: 'center', dataIndex: 'action', width: 200, scopedSlots: { customRender: 'action' } }\n        ],\n        url: {\n          getAvatar: (path) => getFileAccessHttpUrl(`${path}`),\n          // 回收站操作，get = 获取列表；put = 取回；delete = 彻底删除\n          recycleBin: '/sys/user/recycleBin',\n          putRecycleBin: '/sys/user/putRecycleBin',\n          deleteRecycleBin: '/sys/user/deleteRecycleBin',\n        },\n      }\n    },\n    watch: {\n      visible: {\n        immediate: true,\n        handler(val) {\n          if (val) {\n            this.loadData()\n          }\n          this.innerVisible = val\n        }\n      },\n      innerVisible(val) {\n        this.$emit('update:visible', val)\n      },\n    },\n    methods: {\n      loadData() {\n        superRequest.call(this, {\n          loading: true,\n          promise: this.$http.get(this.url.recycleBin),\n          success: res => this.dataSource = res.result\n        })\n      },\n      handleOk() {\n        this.loadData()\n        this.$emit('ok')\n      },\n      handleCancel() {\n        this.innerVisible = false\n      },\n      // 还原用户\n      handleRevert(userIds) {\n        this.$confirm({\n          title: '恢复用户',\n          content: `您确定要恢复这 ${userIds.length} 个用户吗？`,\n          centered: true,\n          onOk: () => {\n            putAction(this.url.putRecycleBin,{userIds:userIds.join(',')}).then((res)=>{\n              if(res.success){\n                this.handleOk()\n                this.handleClearSelection()\n                this.$message.success(`还原 ${userIds.length} 个用户成功！`)\n              }\n            })\n          }\n        })\n      },\n      // 彻底删除用户\n      handleDelete(userIds) {\n        this.$confirm({\n          title: '彻底删除用户',\n          content: (<div>\n            <p>您确定要彻底删除这 {userIds.length} 个用户吗？</p>\n            <p style=\"color:red;\">注意：彻底删除后将无法恢复，请谨慎操作！</p>\n          </div>),\n          centered: true,\n          onOk: () => {\n            var that = this;\n            deleteAction(that.url.deleteRecycleBin, {userIds: userIds.join(',')}).then((res) => {\n              if (res.success) {\n                this.loadData()\n                this.handleClearSelection()\n                this.$message.success(`彻底删除 ${userIds.length} 个用户成功！`)\n              } else {\n                that.$message.warning(res.message);\n              }\n            });\n          },\n        })\n      },\n      handleRevertBatch() {\n        this.handleRevert(this.selectedRowKeys)\n      },\n      handleDeleteBatch() {\n        this.handleDelete(this.selectedRowKeys)\n      },\n      handleClearSelection() {\n        this.handleTableSelectChange([], [])\n      },\n      handleTableSelectChange(selectedRowKeys, selectionRows) {\n        this.selectedRowKeys = selectedRowKeys\n        this.selectionRows = selectionRows\n      },\n    }\n  }\n</script>\n\n<style lang=\"less\" scoped></style>"],"mappings":"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","ignoreList":[]}]}