{"remainingRequest":"E:\\work-25\\知识库系统\\admin\\node_modules\\babel-loader\\lib\\index.js!E:\\work-25\\知识库系统\\admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\work-25\\知识库系统\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\work-25\\知识库系统\\admin\\src\\components\\jeecg\\JUpload.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\work-25\\知识库系统\\admin\\src\\components\\jeecg\\JUpload.vue","mtime":1704718216000},{"path":"E:\\work-25\\知识库系统\\admin\\babel.config.js","mtime":1704718216000},{"path":"E:\\work-25\\知识库系统\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\work-25\\知识库系统\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\work-25\\知识库系统\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\work-25\\知识库系统\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import Vue from 'vue';\nimport { ACCESS_TOKEN } from \"@/store/mutation-types\";\nimport { getFileAccessHttpUrl } from '@/api/manage';\nvar FILE_TYPE_ALL = \"all\";\nvar FILE_TYPE_IMG = \"image\";\nvar FILE_TYPE_TXT = \"file\";\nvar uidGenerator = function uidGenerator() {\n  return '-' + parseInt(Math.random() * 10000 + 1, 10);\n};\nvar getFileName = function getFileName(path) {\n  if (path.lastIndexOf(\"\\\\\") >= 0) {\n    var reg = new RegExp(\"\\\\\\\\\", \"g\");\n    path = path.replace(reg, \"/\");\n  }\n  return path.substring(path.lastIndexOf(\"/\") + 1);\n};\nexport default {\n  name: 'JUpload',\n  data: function data() {\n    return {\n      uploadAction: window._CONFIG['domianURL'] + \"/sys/common/upload\",\n      headers: {},\n      fileList: [],\n      newFileList: [],\n      uploadGoOn: true,\n      previewVisible: false,\n      //---------------------------- begin 图片左右换位置 -------------------------------------\n      previewImage: '',\n      containerId: '',\n      top: '',\n      left: '',\n      moveDisplay: 'none',\n      showMoverTask: false,\n      moverHold: false,\n      currentImg: ''\n      //---------------------------- end 图片左右换位置 -------------------------------------\n    };\n  },\n  props: {\n    text: {\n      type: String,\n      required: false,\n      default: \"点击上传\"\n    },\n    fileType: {\n      type: String,\n      required: false,\n      default: FILE_TYPE_ALL\n    },\n    /*这个属性用于控制文件上传的业务路径*/\n    bizPath: {\n      type: String,\n      required: false,\n      default: \"temp\"\n    },\n    value: {\n      type: [String, Array],\n      required: false\n    },\n    // update-begin- --- author:wangshuai ------ date:20190929 ---- for:Jupload组件增加是否能够点击\n    disabled: {\n      type: Boolean,\n      required: false,\n      default: false\n    },\n    // update-end- --- author:wangshuai ------ date:20190929 ---- for:Jupload组件增加是否能够点击\n    //此属性被废弃了\n    triggerChange: {\n      type: Boolean,\n      required: false,\n      default: false\n    },\n    /**\n     * update -- author:lvdandan -- date:20190219 -- for:Jupload组件增加是否返回url，\n     * true：仅返回url\n     * false：返回fileName filePath fileSize\n     */\n    returnUrl: {\n      type: Boolean,\n      required: false,\n      default: true\n    },\n    number: {\n      type: Number,\n      required: false,\n      default: 0\n    },\n    buttonVisible: {\n      type: Boolean,\n      required: false,\n      default: true\n    },\n    multiple: {\n      type: Boolean,\n      default: true\n    }\n  },\n  watch: {\n    value: {\n      immediate: true,\n      handler: function handler() {\n        var val = this.value;\n        if (val instanceof Array) {\n          if (this.returnUrl) {\n            this.initFileList(val.join(','));\n          } else {\n            this.initFileListArr(val);\n          }\n        } else {\n          this.initFileList(val);\n        }\n      }\n    }\n  },\n  computed: {\n    isImageComp: function isImageComp() {\n      return this.fileType === FILE_TYPE_IMG;\n    },\n    complistType: function complistType() {\n      return this.fileType === FILE_TYPE_IMG ? 'picture-card' : 'text';\n    }\n  },\n  created: function created() {\n    var token = Vue.ls.get(ACCESS_TOKEN);\n    //---------------------------- begin 图片左右换位置 -------------------------------------\n    this.headers = {\n      \"X-Access-Token\": token\n    };\n    this.containerId = 'container-ty-' + new Date().getTime();\n    //---------------------------- end 图片左右换位置 -------------------------------------\n  },\n  methods: {\n    initFileListArr: function initFileListArr(val) {\n      if (!val || val.length == 0) {\n        this.fileList = [];\n        return;\n      }\n      var fileList = [];\n      for (var a = 0; a < val.length; a++) {\n        var url = getFileAccessHttpUrl(val[a].filePath);\n        fileList.push({\n          uid: uidGenerator(),\n          name: val[a].fileName,\n          status: 'done',\n          url: url,\n          response: {\n            status: \"history\",\n            message: val[a].filePath\n          }\n        });\n      }\n      this.fileList = fileList;\n    },\n    initFileList: function initFileList(paths) {\n      if (!paths || paths.length == 0) {\n        //return [];\n        // update-begin- --- author:os_chengtgen ------ date:20190729 ---- for:issues:326,Jupload组件初始化bug\n        this.fileList = [];\n        return;\n        // update-end- --- author:os_chengtgen ------ date:20190729 ---- for:issues:326,Jupload组件初始化bug\n      }\n      var fileList = [];\n      var arr = paths.split(\",\");\n      for (var a = 0; a < arr.length; a++) {\n        var url = getFileAccessHttpUrl(arr[a]);\n        fileList.push({\n          uid: uidGenerator(),\n          name: getFileName(arr[a]),\n          status: 'done',\n          url: url,\n          response: {\n            status: \"history\",\n            message: arr[a]\n          }\n        });\n      }\n      this.fileList = fileList;\n    },\n    handlePathChange: function handlePathChange() {\n      var uploadFiles = this.fileList;\n      var path = '';\n      if (!uploadFiles || uploadFiles.length == 0) {\n        path = '';\n      }\n      var arr = [];\n      for (var a = 0; a < uploadFiles.length; a++) {\n        // update-begin-author:lvdandan date:20200603 for:【TESTA-514】【开源issue】多个文件同时上传时，控制台报错\n        if (uploadFiles[a].status === 'done') {\n          arr.push(uploadFiles[a].response.message);\n        } else {\n          return;\n        }\n        // update-end-author:lvdandan date:20200603 for:【TESTA-514】【开源issue】多个文件同时上传时，控制台报错\n      }\n      if (arr.length > 0) {\n        path = arr.join(\",\");\n      }\n      this.$emit('change', path);\n    },\n    beforeUpload: function beforeUpload(file) {\n      this.uploadGoOn = true;\n      var fileType = file.type;\n      if (this.fileType === FILE_TYPE_IMG) {\n        if (fileType.indexOf('image') < 0) {\n          this.$message.warning('请上传图片');\n          this.uploadGoOn = false;\n          return false;\n        }\n      }\n      //TODO 扩展功能验证文件大小\n      return true;\n    },\n    handleChange: function handleChange(info) {\n      console.log(\"--文件列表改变--\");\n      if (!info.file.status && this.uploadGoOn === false) {\n        info.fileList.pop();\n      }\n      var fileList = info.fileList;\n      if (info.file.status === 'done') {\n        if (this.number > 0) {\n          fileList = fileList.slice(-this.number);\n        }\n        if (info.file.response.success) {\n          fileList = fileList.map(function (file) {\n            if (file.response) {\n              var reUrl = file.response.message;\n              file.url = getFileAccessHttpUrl(reUrl);\n            }\n            return file;\n          });\n        }\n        //this.$message.success(`${info.file.name} 上传成功!`);\n      } else if (info.file.status === 'error') {\n        this.$message.error(\"\".concat(info.file.name, \" \\u4E0A\\u4F20\\u5931\\u8D25.\"));\n      } else if (info.file.status === 'removed') {\n        this.handleDelete(info.file);\n      }\n      this.fileList = fileList;\n      if (info.file.status === 'done' || info.file.status === 'removed') {\n        //returnUrl为true时仅返回文件路径\n        if (this.returnUrl) {\n          this.handlePathChange();\n        } else {\n          //returnUrl为false时返回文件名称、文件路径及文件大小\n          this.newFileList = [];\n          for (var a = 0; a < fileList.length; a++) {\n            // update-begin-author:lvdandan date:20200603 for:【TESTA-514】【开源issue】多个文件同时上传时，控制台报错\n            if (fileList[a].status === 'done') {\n              var fileJson = {\n                fileName: fileList[a].name,\n                filePath: fileList[a].response.message,\n                fileSize: fileList[a].size\n              };\n              this.newFileList.push(fileJson);\n            } else {\n              return;\n            }\n            // update-end-author:lvdandan date:20200603 for:【TESTA-514】【开源issue】多个文件同时上传时，控制台报错\n          }\n          this.$emit('change', this.newFileList);\n        }\n      }\n    },\n    handleDelete: function handleDelete(file) {\n      //如有需要新增 删除逻辑\n      console.log(file);\n    },\n    handlePreview: function handlePreview(file) {\n      if (this.fileType === FILE_TYPE_IMG) {\n        this.previewImage = file.url || file.thumbUrl;\n        this.previewVisible = true;\n      } else {\n        location.href = file.url;\n      }\n    },\n    handleCancel: function handleCancel() {\n      this.previewVisible = false;\n    },\n    //---------------------------- begin 图片左右换位置 -------------------------------------\n    moveLast: function moveLast() {\n      //console.log(ev)\n      //console.log(this.fileList)\n      //console.log(this.currentImg)\n      var index = this.getIndexByUrl();\n      if (index == 0) {\n        this.$message.warn('未知的操作');\n      } else {\n        var curr = this.fileList[index].url;\n        var last = this.fileList[index - 1].url;\n        var arr = [];\n        for (var i = 0; i < this.fileList.length; i++) {\n          if (i == index - 1) {\n            arr.push(curr);\n          } else if (i == index) {\n            arr.push(last);\n          } else {\n            arr.push(this.fileList[i].url);\n          }\n        }\n        this.currentImg = last;\n        this.$emit('change', arr.join(','));\n      }\n    },\n    moveNext: function moveNext() {\n      var index = this.getIndexByUrl();\n      if (index == this.fileList.length - 1) {\n        this.$message.warn('已到最后~');\n      } else {\n        var curr = this.fileList[index].url;\n        var next = this.fileList[index + 1].url;\n        var arr = [];\n        for (var i = 0; i < this.fileList.length; i++) {\n          if (i == index + 1) {\n            arr.push(curr);\n          } else if (i == index) {\n            arr.push(next);\n          } else {\n            arr.push(this.fileList[i].url);\n          }\n        }\n        this.currentImg = next;\n        this.$emit('change', arr.join(','));\n      }\n    },\n    getIndexByUrl: function getIndexByUrl() {\n      for (var i = 0; i < this.fileList.length; i++) {\n        if (this.fileList[i].url === this.currentImg || encodeURI(this.fileList[i].url) === this.currentImg) {\n          return i;\n        }\n      }\n      return -1;\n    }\n  },\n  mounted: function mounted() {\n    var _this = this;\n    var moverObj = document.getElementById(this.containerId + '-mover');\n    if (moverObj) {\n      moverObj.addEventListener('mouseover', function () {\n        _this.moverHold = true;\n        _this.moveDisplay = 'block';\n      });\n      moverObj.addEventListener('mouseout', function () {\n        _this.moverHold = false;\n        _this.moveDisplay = 'none';\n      });\n    }\n    var picList = document.getElementById(this.containerId) ? document.getElementById(this.containerId).getElementsByClassName('ant-upload-list-picture-card') : [];\n    if (picList && picList.length > 0) {\n      picList[0].addEventListener('mouseover', function (ev) {\n        ev = ev || window.event;\n        var target = ev.target || ev.srcElement;\n        if ('ant-upload-list-item-info' == target.className) {\n          _this.showMoverTask = false;\n          var item = target.parentElement;\n          _this.left = item.offsetLeft;\n          _this.top = item.offsetTop + item.offsetHeight - 50;\n          _this.moveDisplay = 'block';\n          _this.currentImg = target.getElementsByTagName('img')[0].src;\n        }\n      });\n      picList[0].addEventListener('mouseout', function (ev) {\n        ev = ev || window.event;\n        var target = ev.target || ev.srcElement;\n        //console.log('移除',target)\n        if ('ant-upload-list-item-info' == target.className) {\n          _this.showMoverTask = true;\n          setTimeout(function () {\n            if (_this.moverHold === false) _this.moveDisplay = 'none';\n          }, 100);\n        }\n        if ('ant-upload-list-item ant-upload-list-item-done' == target.className || 'ant-upload-list ant-upload-list-picture-card' == target.className) {\n          _this.moveDisplay = 'none';\n        }\n      });\n      //---------------------------- end 图片左右换位置 -------------------------------------\n    }\n  },\n  model: {\n    prop: 'value',\n    event: 'change'\n  }\n};",{"version":3,"names":["Vue","ACCESS_TOKEN","getFileAccessHttpUrl","FILE_TYPE_ALL","FILE_TYPE_IMG","FILE_TYPE_TXT","uidGenerator","parseInt","Math","random","getFileName","path","lastIndexOf","reg","RegExp","replace","substring","name","data","uploadAction","window","_CONFIG","headers","fileList","newFileList","uploadGoOn","previewVisible","previewImage","containerId","top","left","moveDisplay","showMoverTask","moverHold","currentImg","props","text","type","String","required","default","fileType","bizPath","value","Array","disabled","Boolean","triggerChange","returnUrl","number","Number","buttonVisible","multiple","watch","immediate","handler","val","initFileList","join","initFileListArr","computed","isImageComp","complistType","created","token","ls","get","Date","getTime","methods","length","a","url","filePath","push","uid","fileName","status","response","message","paths","arr","split","handlePathChange","uploadFiles","$emit","beforeUpload","file","indexOf","$message","warning","handleChange","info","console","log","pop","slice","success","map","reUrl","error","concat","handleDelete","fileJson","fileSize","size","handlePreview","thumbUrl","location","href","handleCancel","moveLast","index","getIndexByUrl","warn","curr","last","i","moveNext","next","encodeURI","mounted","_this","moverObj","document","getElementById","addEventListener","picList","getElementsByClassName","ev","event","target","srcElement","className","item","parentElement","offsetLeft","offsetTop","offsetHeight","getElementsByTagName","src","setTimeout","model","prop"],"sources":["src/components/jeecg/JUpload.vue"],"sourcesContent":["<template>\n  <div :id=\"containerId\" style=\"position: relative\">\n\n    <!--  ---------------------------- begin 图片左右换位置 ------------------------------------- -->\n    <div class=\"movety-container\" :style=\"{top:top+'px',left:left+'px',display:moveDisplay}\" style=\"padding:0 8px;position: absolute;z-index: 91;height: 32px;width: 104px;text-align: center;\">\n      <div :id=\"containerId+'-mover'\" :class=\"showMoverTask?'uploadty-mover-mask':'movety-opt'\" style=\"margin-top: 12px\">\n        <a @click=\"moveLast\" style=\"margin: 0 5px;\"><a-icon type=\"arrow-left\" style=\"color: #fff;font-size: 16px\"/></a>\n        <a @click=\"moveNext\" style=\"margin: 0 5px;\"><a-icon type=\"arrow-right\" style=\"color: #fff;font-size: 16px\"/></a>\n      </div>\n    </div>\n    <!--  ---------------------------- end 图片左右换位置 ------------------------------------- -->\n\n    <a-upload\n      name=\"file\"\n      :multiple=\"multiple\"\n      :action=\"uploadAction\"\n      :headers=\"headers\"\n      :data=\"{'biz':bizPath}\"\n      :fileList=\"fileList\"\n      :beforeUpload=\"beforeUpload\"\n      @change=\"handleChange\"\n      :disabled=\"disabled\"\n      :returnUrl=\"returnUrl\"\n      :listType=\"complistType\"\n      @preview=\"handlePreview\"\n      :class=\"{'uploadty-disabled':disabled}\">\n      <template>\n        <div v-if=\"isImageComp\">\n          <a-icon type=\"plus\" />\n          <div class=\"ant-upload-text\">{{ text }}</div>\n        </div>\n        <a-button v-else-if=\"buttonVisible\">\n         <a-icon type=\"upload\" />{{ text }}\n        </a-button>\n      </template>\n    </a-upload>\n    <a-modal :visible=\"previewVisible\" :footer=\"null\" @cancel=\"handleCancel\">\n      <img alt=\"example\" style=\"width: 100%\" :src=\"previewImage\" />\n    </a-modal>\n  </div>\n</template>\n\n<script>\n\n  import Vue from 'vue'\n  import { ACCESS_TOKEN } from \"@/store/mutation-types\"\n  import { getFileAccessHttpUrl } from '@/api/manage';\n\n  const FILE_TYPE_ALL = \"all\"\n  const FILE_TYPE_IMG = \"image\"\n  const FILE_TYPE_TXT = \"file\"\n  const uidGenerator=()=>{\n    return '-'+parseInt(Math.random()*10000+1,10);\n  }\n  const getFileName=(path)=>{\n    if(path.lastIndexOf(\"\\\\\")>=0){\n      let reg=new RegExp(\"\\\\\\\\\",\"g\");\n      path = path.replace(reg,\"/\");\n    }\n    return path.substring(path.lastIndexOf(\"/\")+1);\n  }\n  export default {\n    name: 'JUpload',\n    data(){\n      return {\n        uploadAction:window._CONFIG['domianURL']+\"/sys/common/upload\",\n        headers:{},\n        fileList: [],\n        newFileList: [],\n        uploadGoOn:true,\n        previewVisible: false,\n        //---------------------------- begin 图片左右换位置 -------------------------------------\n        previewImage: '',\n        containerId:'',\n        top:'',\n        left:'',\n        moveDisplay:'none',\n        showMoverTask:false,\n        moverHold:false,\n        currentImg:''\n        //---------------------------- end 图片左右换位置 -------------------------------------\n      }\n    },\n    props:{\n      text:{\n        type:String,\n        required:false,\n        default:\"点击上传\"\n      },\n      fileType:{\n        type:String,\n        required:false,\n        default:FILE_TYPE_ALL\n      },\n      /*这个属性用于控制文件上传的业务路径*/\n      bizPath:{\n        type:String,\n        required:false,\n        default:\"temp\"\n      },\n      value:{\n        type:[String,Array],\n        required:false\n      },\n      // update-begin- --- author:wangshuai ------ date:20190929 ---- for:Jupload组件增加是否能够点击\n      disabled:{\n        type:Boolean,\n        required:false,\n        default: false\n      },\n      // update-end- --- author:wangshuai ------ date:20190929 ---- for:Jupload组件增加是否能够点击\n      //此属性被废弃了\n      triggerChange:{\n        type: Boolean,\n        required: false,\n        default: false\n      },\n      /**\n       * update -- author:lvdandan -- date:20190219 -- for:Jupload组件增加是否返回url，\n       * true：仅返回url\n       * false：返回fileName filePath fileSize\n       */\n      returnUrl:{\n        type:Boolean,\n        required:false,\n        default: true\n      },\n      number:{\n        type:Number,\n        required:false,\n        default: 0\n      },\n      buttonVisible:{\n        type:Boolean,\n        required:false,\n        default: true\n      },\n      multiple: {\n        type: Boolean,\n        default: true\n      },\n    },\n    watch:{\n      value:{\n        immediate: true,\n        handler() {\n          let val = this.value\n          if (val instanceof Array) {\n            if(this.returnUrl){\n              this.initFileList(val.join(','))\n            }else{\n              this.initFileListArr(val);\n            }\n          } else {\n            this.initFileList(val)\n          }\n        }\n      }\n    },\n    computed:{\n      isImageComp(){\n        return this.fileType === FILE_TYPE_IMG\n      },\n      complistType(){\n        return this.fileType === FILE_TYPE_IMG?'picture-card':'text'\n      }\n    },\n    created(){\n      const token = Vue.ls.get(ACCESS_TOKEN);\n      //---------------------------- begin 图片左右换位置 -------------------------------------\n      this.headers = {\"X-Access-Token\":token};\n      this.containerId = 'container-ty-'+new Date().getTime();\n      //---------------------------- end 图片左右换位置 -------------------------------------\n    },\n\n    methods:{\n      initFileListArr(val){\n        if(!val || val.length==0){\n          this.fileList = [];\n          return;\n        }\n        let fileList = [];\n        for(var a=0;a<val.length;a++){\n          let url = getFileAccessHttpUrl(val[a].filePath);\n          fileList.push({\n            uid:uidGenerator(),\n            name:val[a].fileName,\n            status: 'done',\n            url: url,\n            response:{\n              status:\"history\",\n              message:val[a].filePath\n            }\n          })\n        }\n        this.fileList = fileList\n      },\n      initFileList(paths){\n        if(!paths || paths.length==0){\n          //return [];\n          // update-begin- --- author:os_chengtgen ------ date:20190729 ---- for:issues:326,Jupload组件初始化bug\n          this.fileList = [];\n          return;\n          // update-end- --- author:os_chengtgen ------ date:20190729 ---- for:issues:326,Jupload组件初始化bug\n        }\n        let fileList = [];\n        let arr = paths.split(\",\")\n        for(var a=0;a<arr.length;a++){\n          let url = getFileAccessHttpUrl(arr[a]);\n          fileList.push({\n            uid:uidGenerator(),\n            name:getFileName(arr[a]),\n            status: 'done',\n            url: url,\n            response:{\n              status:\"history\",\n              message:arr[a]\n            }\n          })\n        }\n        this.fileList = fileList\n      },\n      handlePathChange(){\n        let uploadFiles = this.fileList\n        let path = ''\n        if(!uploadFiles || uploadFiles.length==0){\n          path = ''\n        }\n        let arr = [];\n\n        for(var a=0;a<uploadFiles.length;a++){\n          // update-begin-author:lvdandan date:20200603 for:【TESTA-514】【开源issue】多个文件同时上传时，控制台报错\n          if(uploadFiles[a].status === 'done' ) {\n            arr.push(uploadFiles[a].response.message)\n          }else{\n            return;\n          }\n          // update-end-author:lvdandan date:20200603 for:【TESTA-514】【开源issue】多个文件同时上传时，控制台报错\n        }\n        if(arr.length>0){\n          path = arr.join(\",\")\n        }\n        this.$emit('change', path);\n      },\n      beforeUpload(file){\n        this.uploadGoOn=true\n        var fileType = file.type;\n        if(this.fileType===FILE_TYPE_IMG){\n          if(fileType.indexOf('image')<0){\n            this.$message.warning('请上传图片');\n            this.uploadGoOn=false\n            return false;\n          }\n        }\n        //TODO 扩展功能验证文件大小\n        return true\n      },\n      handleChange(info) {\n        console.log(\"--文件列表改变--\")\n        if(!info.file.status && this.uploadGoOn === false){\n          info.fileList.pop();\n        }\n        let fileList = info.fileList\n        if(info.file.status==='done'){\n          if(this.number>0){\n            fileList = fileList.slice(-this.number);\n          }\n          if(info.file.response.success){\n            fileList = fileList.map((file) => {\n              if (file.response) {\n                let reUrl = file.response.message;\n                file.url = getFileAccessHttpUrl(reUrl);\n              }\n              return file;\n            });\n          }\n          //this.$message.success(`${info.file.name} 上传成功!`);\n        }else if (info.file.status === 'error') {\n          this.$message.error(`${info.file.name} 上传失败.`);\n        }else if(info.file.status === 'removed'){\n          this.handleDelete(info.file)\n        }\n        this.fileList = fileList\n        if(info.file.status==='done' || info.file.status === 'removed'){\n          //returnUrl为true时仅返回文件路径\n          if(this.returnUrl){\n            this.handlePathChange()\n          }else{\n            //returnUrl为false时返回文件名称、文件路径及文件大小\n            this.newFileList = [];\n            for(var a=0;a<fileList.length;a++){\n              // update-begin-author:lvdandan date:20200603 for:【TESTA-514】【开源issue】多个文件同时上传时，控制台报错\n              if(fileList[a].status === 'done' ) {\n                var fileJson = {\n                  fileName:fileList[a].name,\n                  filePath:fileList[a].response.message,\n                  fileSize:fileList[a].size\n                };\n                this.newFileList.push(fileJson);\n              }else{\n                return;\n              }\n              // update-end-author:lvdandan date:20200603 for:【TESTA-514】【开源issue】多个文件同时上传时，控制台报错\n            }\n            this.$emit('change', this.newFileList);\n          }\n        }\n      },\n      handleDelete(file){\n        //如有需要新增 删除逻辑\n        console.log(file)\n      },\n      handlePreview(file){\n        if(this.fileType === FILE_TYPE_IMG){\n          this.previewImage = file.url || file.thumbUrl;\n          this.previewVisible = true;\n        }else{\n          location.href=file.url\n        }\n      },\n      handleCancel(){\n        this.previewVisible = false;\n      },\n      //---------------------------- begin 图片左右换位置 -------------------------------------\n      moveLast(){\n        //console.log(ev)\n        //console.log(this.fileList)\n        //console.log(this.currentImg)\n        let index = this.getIndexByUrl();\n        if(index==0){\n          this.$message.warn('未知的操作')\n        }else{\n          let curr = this.fileList[index].url;\n          let last = this.fileList[index-1].url;\n          let arr =[]\n          for(let i=0;i<this.fileList.length;i++){\n            if(i==index-1){\n              arr.push(curr)\n            }else if(i==index){\n              arr.push(last)\n            }else{\n              arr.push(this.fileList[i].url)\n            }\n          }\n          this.currentImg = last\n          this.$emit('change',arr.join(','))\n        }\n      },\n      moveNext(){\n        let index = this.getIndexByUrl();\n        if(index==this.fileList.length-1){\n          this.$message.warn('已到最后~')\n        }else{\n          let curr = this.fileList[index].url;\n          let next = this.fileList[index+1].url;\n          let arr =[]\n          for(let i=0;i<this.fileList.length;i++){\n            if(i==index+1){\n              arr.push(curr)\n            }else if(i==index){\n              arr.push(next)\n            }else{\n              arr.push(this.fileList[i].url)\n            }\n          }\n          this.currentImg = next\n          this.$emit('change',arr.join(','))\n        }\n      },\n      getIndexByUrl(){\n        for(let i=0;i<this.fileList.length;i++){\n          if(this.fileList[i].url === this.currentImg || encodeURI(this.fileList[i].url) === this.currentImg){\n            return i;\n          }\n        }\n        return -1;\n      }\n    },\n    mounted(){\n      const moverObj = document.getElementById(this.containerId+'-mover');\n      if(moverObj){\n        moverObj.addEventListener('mouseover',()=>{\n          this.moverHold = true\n          this.moveDisplay = 'block';\n        });\n        moverObj.addEventListener('mouseout',()=>{\n          this.moverHold = false\n          this.moveDisplay = 'none';\n        });\n      }\n    \n      let picList = document.getElementById(this.containerId)?document.getElementById(this.containerId).getElementsByClassName('ant-upload-list-picture-card'):[];\n      if(picList && picList.length>0){\n        picList[0].addEventListener('mouseover',(ev)=>{\n          ev = ev || window.event;\n          let target = ev.target || ev.srcElement;\n          if('ant-upload-list-item-info' == target.className){\n            this.showMoverTask=false\n            let item = target.parentElement\n            this.left = item.offsetLeft\n            this.top=item.offsetTop+item.offsetHeight-50;\n            this.moveDisplay = 'block';\n            this.currentImg = target.getElementsByTagName('img')[0].src\n          }\n\n        });\n\n        picList[0].addEventListener('mouseout',(ev)=>{\n          ev = ev || window.event;\n          let target = ev.target || ev.srcElement;\n          //console.log('移除',target)\n          if('ant-upload-list-item-info' == target.className){\n            this.showMoverTask=true\n            setTimeout(()=>{\n              if(this.moverHold === false)\n                this.moveDisplay = 'none';\n            },100)\n          }\n          if('ant-upload-list-item ant-upload-list-item-done' == target.className || 'ant-upload-list ant-upload-list-picture-card'== target.className){\n            this.moveDisplay = 'none';\n          }\n        })\n        //---------------------------- end 图片左右换位置 -------------------------------------\n      }\n    },\n    model: {\n      prop: 'value',\n      event: 'change'\n    }\n  }\n</script>\n\n<style lang=\"less\">\n.uploadty-disabled{\n  .ant-upload-list-item {\n    .anticon-close{\n      display: none;\n    }\n    .anticon-delete{\n      display: none;\n    }\n  }\n}\n  //---------------------------- begin 图片左右换位置 -------------------------------------\n  .uploadty-mover-mask{\n    background-color: rgba(0, 0, 0, 0.5);\n    opacity: .8;\n    color: #fff;\n    height: 28px;\n    line-height: 28px;\n  }\n  //---------------------------- end 图片左右换位置 -------------------------------------\n</style>"],"mappings":"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","ignoreList":[]}]}