{"remainingRequest":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js!F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\src\\store\\modules\\permission.js","dependencies":[{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\src\\store\\modules\\permission.js","mtime":1704718217000},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\babel.config.js","mtime":1704718217000},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709701155248},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1709701140363},{"path":"F:\\workspace\\3月\\km_community-main\\ant-design-vue-jeecg\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1709701151904}],"contextDependencies":[],"result":["import { asyncRouterMap, constantRouterMap } from \"@/config/router.config\";\n\n/**\n * 过滤账户是否拥有某一个权限，并将菜单从加载列表移除\n *\n * @param permission\n * @param route\n * @returns {boolean}\n */\nfunction hasPermission(permission, route) {\n  if (route.meta && route.meta.permission) {\n    var flag = -1;\n    for (var i = 0, len = permission.length; i < len; i++) {\n      flag = route.meta.permission.indexOf(permission[i]);\n      if (flag >= 0) {\n        return true;\n      }\n    }\n    return false;\n  }\n  return true;\n}\n\n/**\n * 单账户多角色时，使用该方法可过滤角色不存在的菜单\n *\n * @param roles\n * @param route\n * @returns {*}\n */\n// eslint-disable-next-line\nfunction hasRole(roles, route) {\n  if (route.meta && route.meta.roles) {\n    return route.meta.roles.indexOf(roles.id);\n  } else {\n    return true;\n  }\n}\nfunction filterAsyncRouter(routerMap, roles) {\n  var accessedRouters = routerMap.filter(function (route) {\n    if (hasPermission(roles.permissionList, route)) {\n      if (route.children && route.children.length) {\n        route.children = filterAsyncRouter(route.children, roles);\n      }\n      return true;\n    }\n    return false;\n  });\n  return accessedRouters;\n}\nvar permission = {\n  state: {\n    routers: constantRouterMap,\n    addRouters: []\n  },\n  mutations: {\n    SET_ROUTERS: function SET_ROUTERS(state, data) {\n      state.addRouters = data;\n      state.routers = constantRouterMap.concat(data);\n      //console.log('-----mutations---SET_ROUTERS----', data)\n    }\n  },\n  actions: {\n    GenerateRoutes: function GenerateRoutes(_ref, data) {\n      var commit = _ref.commit;\n      return new Promise(function (resolve) {\n        var roles = data.roles;\n        console.log('-----mutations---data----', data);\n        var accessedRouters;\n        accessedRouters = filterAsyncRouter(asyncRouterMap, roles);\n        console.log('-----mutations---accessedRouters----', accessedRouters);\n        commit('SET_ROUTERS', accessedRouters);\n        resolve();\n      });\n    },\n    // 动态添加主界面路由，需要缓存\n    UpdateAppRouter: function UpdateAppRouter(_ref2, routes) {\n      var commit = _ref2.commit;\n      return new Promise(function (resolve) {\n        //const [ roles ] = routes.constRoutes\n        var routelist = routes.constRoutes;\n        commit('SET_ROUTERS', routelist);\n        resolve();\n      });\n    }\n  }\n};\nexport default permission;",{"version":3,"names":["asyncRouterMap","constantRouterMap","hasPermission","permission","route","meta","flag","i","len","length","indexOf","hasRole","roles","id","filterAsyncRouter","routerMap","accessedRouters","filter","permissionList","children","state","routers","addRouters","mutations","SET_ROUTERS","data","concat","actions","GenerateRoutes","_ref","commit","Promise","resolve","console","log","UpdateAppRouter","_ref2","routes","routelist","constRoutes"],"sources":["F:/workspace/3月/km_community-main/ant-design-vue-jeecg/src/store/modules/permission.js"],"sourcesContent":["import { asyncRouterMap, constantRouterMap } from \"@/config/router.config\"\n\n/**\n * 过滤账户是否拥有某一个权限，并将菜单从加载列表移除\n *\n * @param permission\n * @param route\n * @returns {boolean}\n */\nfunction hasPermission(permission, route) {\n  if (route.meta && route.meta.permission) {\n    let flag = -1\n    for (let i = 0, len = permission.length; i < len; i++) {\n      flag = route.meta.permission.indexOf(permission[i])\n      if (flag >= 0) {\n        return true\n      }\n    }\n    return false\n  }\n  return true\n}\n\n/**\n * 单账户多角色时，使用该方法可过滤角色不存在的菜单\n *\n * @param roles\n * @param route\n * @returns {*}\n */\n// eslint-disable-next-line\nfunction hasRole(roles, route) {\n  if (route.meta && route.meta.roles) {\n    return route.meta.roles.indexOf(roles.id)\n  } else {\n    return true\n  }\n}\n\nfunction filterAsyncRouter(routerMap, roles) {\n  const accessedRouters = routerMap.filter(route => {\n    if (hasPermission(roles.permissionList, route)) {\n      if (route.children && route.children.length) {\n        route.children = filterAsyncRouter(route.children, roles)\n      }\n      return true\n    }\n    return false\n  })\n  return accessedRouters\n}\n\n\nconst permission = {\n  state: {\n    routers: constantRouterMap,\n    addRouters: []\n  },\n  mutations: {\n    SET_ROUTERS: (state, data) => {\n      state.addRouters = data\n      state.routers = constantRouterMap.concat(data)\n      //console.log('-----mutations---SET_ROUTERS----', data)\n    }\n  },\n  actions: {\n    GenerateRoutes({ commit }, data) {\n      return new Promise(resolve => {\n        const { roles } = data\n        console.log('-----mutations---data----', data)\n        let accessedRouters\n        accessedRouters = filterAsyncRouter(asyncRouterMap, roles)\n        console.log('-----mutations---accessedRouters----', accessedRouters)\n        commit('SET_ROUTERS', accessedRouters)\n        resolve()\n      })\n    },\n    // 动态添加主界面路由，需要缓存\n    UpdateAppRouter({ commit }, routes) {\n      return new Promise(resolve => {\n        //const [ roles ] = routes.constRoutes\n        let routelist = routes.constRoutes;\n        commit('SET_ROUTERS', routelist)\n        resolve()\n      })\n    }\n  }\n}\n\nexport default permission"],"mappings":"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","ignoreList":[]}]}