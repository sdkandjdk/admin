{"remainingRequest":"E:\\work-25\\知识库系统\\admin\\node_modules\\babel-loader\\lib\\index.js!E:\\work-25\\知识库系统\\admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\work-25\\知识库系统\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\work-25\\知识库系统\\admin\\src\\components\\jeecg\\JImportModal.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\work-25\\知识库系统\\admin\\src\\components\\jeecg\\JImportModal.vue","mtime":1704718216000},{"path":"E:\\work-25\\知识库系统\\admin\\babel.config.js","mtime":1704718216000},{"path":"E:\\work-25\\知识库系统\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\work-25\\知识库系统\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\work-25\\知识库系统\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\work-25\\知识库系统\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["function _toConsumableArray(r) { return _arrayWithoutHoles(r) || _iterableToArray(r) || _unsupportedIterableToArray(r) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _iterableToArray(r) { if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r); }\nfunction _arrayWithoutHoles(r) { if (Array.isArray(r)) return _arrayLikeToArray(r); }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nimport { postAction } from '@/api/manage';\nexport default {\n  name: 'JImportModal',\n  props: {\n    url: {\n      type: String,\n      default: '',\n      required: false\n    },\n    biz: {\n      type: String,\n      default: '',\n      required: false\n    },\n    //是否online导入\n    online: {\n      type: Boolean,\n      default: false,\n      required: false\n    }\n  },\n  data: function data() {\n    return {\n      visible: false,\n      uploading: false,\n      fileList: [],\n      uploadAction: '',\n      foreignKeys: '',\n      validateStatus: 0\n    };\n  },\n  watch: {\n    url: function url(val) {\n      if (val) {\n        this.uploadAction = window._CONFIG['domianURL'] + val;\n      }\n    }\n  },\n  created: function created() {\n    this.uploadAction = window._CONFIG['domianURL'] + this.url;\n  },\n  methods: {\n    handleClose: function handleClose() {\n      this.visible = false;\n    },\n    show: function show(arg) {\n      this.fileList = [];\n      this.uploading = false;\n      this.visible = true;\n      this.foreignKeys = arg;\n      this.validateStatus = 0;\n    },\n    handleRemove: function handleRemove(file) {\n      var index = this.fileList.indexOf(file);\n      var newFileList = this.fileList.slice();\n      newFileList.splice(index, 1);\n      this.fileList = newFileList;\n    },\n    beforeUpload: function beforeUpload(file) {\n      this.fileList = [].concat(_toConsumableArray(this.fileList), [file]);\n      return false;\n    },\n    handleImport: function handleImport() {\n      var _this = this;\n      var fileList = this.fileList;\n      var formData = new FormData();\n      if (this.biz) {\n        formData.append('isSingleTableImport', this.biz);\n      }\n      if (this.foreignKeys && this.foreignKeys.length > 0) {\n        formData.append('foreignKeys', this.foreignKeys);\n      }\n      if (this.online == true) {\n        formData.append('validateStatus', this.validateStatus);\n      }\n      fileList.forEach(function (file) {\n        formData.append('files[]', file);\n      });\n      this.uploading = true;\n      postAction(this.uploadAction, formData).then(function (res) {\n        _this.uploading = false;\n        if (res.success) {\n          if (res.code == 201) {\n            _this.errorTip(res.message, res.result);\n          } else {\n            _this.$message.success(res.message);\n          }\n          _this.visible = false;\n          _this.$emit('ok');\n        } else {\n          _this.$message.warning(res.message);\n        }\n      });\n    },\n    // 是否开启校验 开关改变事件\n    handleChangeValidateStatus: function handleChangeValidateStatus(checked) {\n      this.validateStatus = checked == true ? 1 : 0;\n    },\n    // 错误信息提示\n    errorTip: function errorTip(tipMessage, fileUrl) {\n      var h = this.$createElement;\n      var href = window._CONFIG['domianURL'] + fileUrl;\n      this.$warning({\n        title: '导入成功,但是有错误数据!',\n        content: h('div', {}, [h('div', tipMessage), h('span', '具体详情请 '), h('a', {\n          attrs: {\n            href: href,\n            target: '_blank'\n          }\n        }, '点击下载')]),\n        onOk: function onOk() {}\n      });\n    }\n  }\n};",{"version":3,"names":["postAction","name","props","url","type","String","default","required","biz","online","Boolean","data","visible","uploading","fileList","uploadAction","foreignKeys","validateStatus","watch","val","window","_CONFIG","created","methods","handleClose","show","arg","handleRemove","file","index","indexOf","newFileList","slice","splice","beforeUpload","concat","_toConsumableArray","handleImport","_this","formData","FormData","append","length","forEach","then","res","success","code","errorTip","message","result","$message","$emit","warning","handleChangeValidateStatus","checked","tipMessage","fileUrl","h","$createElement","href","$warning","title","content","attrs","target","onOk"],"sources":["src/components/jeecg/JImportModal.vue"],"sourcesContent":["<template>\n  <a-modal\n    title=\"导入EXCEL\"\n    :width=\"600\"\n    :visible=\"visible\"\n    :confirmLoading=\"uploading\"\n    @cancel=\"handleClose\">\n\n    <div style=\"margin: 0 0 5px 1px\" v-if=\"online\">\n      <span style=\"display: inline-block;height: 32px;line-height: 32px;vertical-align: middle;\">是否开启校验:</span>\n      <span style=\"display: inline-block;height: 32px;margin-left: 6px\">\n         <a-switch :checked=\"validateStatus==1\" @change=\"handleChangeValidateStatus\" checked-children=\"是\" un-checked-children=\"否\" size=\"small\"/>\n      </span>\n    </div>\n\n    <a-upload\n      name=\"file\"\n      :multiple=\"true\"\n      accept=\".xls,.xlsx\"\n      :fileList=\"fileList\"\n      :remove=\"handleRemove\"\n      :beforeUpload=\"beforeUpload\">\n      <a-button>\n        <a-icon type=\"upload\" />\n        选择导入文件\n      </a-button>\n    </a-upload>\n\n    <template slot=\"footer\">\n      <a-button @click=\"handleClose\">关闭</a-button>\n      <a-button\n        type=\"primary\"\n        @click=\"handleImport\"\n        :disabled=\"fileList.length === 0\"\n        :loading=\"uploading\">\n        {{ uploading ? '上传中...' : '开始上传' }}\n      </a-button>\n    </template>\n\n  </a-modal>\n</template>\n\n<script>\n  import { postAction } from '@/api/manage'\n  export default {\n    name: 'JImportModal',\n    props:{\n      url:{\n        type: String,\n        default: '',\n        required: false\n      },\n      biz:{\n        type: String,\n        default: '',\n        required: false\n      },\n      //是否online导入\n      online:{\n        type: Boolean,\n        default: false,\n        required: false\n      }\n    },\n    data(){\n      return {\n        visible:false,\n        uploading:false,\n        fileList:[],\n        uploadAction:'',\n        foreignKeys:'',\n        validateStatus: 0\n      }\n    },\n    watch: {\n      url (val) {\n        if(val){\n         this.uploadAction = window._CONFIG['domianURL']+val\n        }\n      }\n    },\n    created () {\n      this.uploadAction = window._CONFIG['domianURL']+this.url\n    },\n\n    methods:{\n      handleClose(){\n        this.visible=false\n      },\n      show(arg){\n        this.fileList = []\n        this.uploading = false\n        this.visible = true\n        this.foreignKeys = arg;\n        this.validateStatus = 0\n      },\n      handleRemove(file) {\n        const index = this.fileList.indexOf(file);\n        const newFileList = this.fileList.slice();\n        newFileList.splice(index, 1);\n        this.fileList = newFileList\n      },\n      beforeUpload(file) {\n        this.fileList = [...this.fileList, file]\n        return false;\n      },\n      handleImport() {\n        const { fileList } = this;\n        const formData = new FormData();\n        if(this.biz){\n          formData.append('isSingleTableImport',this.biz);\n        }\n        if(this.foreignKeys && this.foreignKeys.length>0){\n          formData.append('foreignKeys',this.foreignKeys);\n        }\n        if(this.online==true){\n          formData.append('validateStatus',this.validateStatus);\n        }\n        fileList.forEach((file) => {\n          formData.append('files[]', file);\n        });\n        this.uploading = true\n        postAction(this.uploadAction, formData).then((res) => {\n          this.uploading = false\n          if(res.success){\n            if(res.code == 201){\n              this.errorTip(res.message, res.result)\n            }else{\n              this.$message.success(res.message)\n            }\n            this.visible=false\n            this.$emit('ok')\n          }else{\n            this.$message.warning(res.message)\n          }\n        })\n      },\n      // 是否开启校验 开关改变事件\n      handleChangeValidateStatus(checked){\n        this.validateStatus = checked==true?1:0\n      },\n      // 错误信息提示\n      errorTip(tipMessage, fileUrl) {\n        const h = this.$createElement;\n        let href = window._CONFIG['domianURL'] + fileUrl\n        this.$warning({\n          title: '导入成功,但是有错误数据!',\n          content: h('div', {}, [\n            h('div', tipMessage),\n            h('span', '具体详情请 '),\n            h('a', {\n              attrs: {\n                href: href,\n                target: '_blank'\n              },\n            },'点击下载'),\n          ]),\n          onOk() {},\n        });\n      },\n\n    }\n  }\n</script>\n\n<style scoped>\n\n</style>"],"mappings":"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","ignoreList":[]}]}